<div class="flex">
  <div id="playerEdit" class="player-edit" [class]="$videoSegments?.videoSegments ? 'w-[calc(100%-320px)]' : 'w-full'">
    <div id="playerContainer" class="player-video" [class]="store.state.fileInfo[0] ? 'flex' : 'hidden'">
      <div id="$playerContainer" class="player-video flex">
        <div *ngFor="let file of store.state.fileInfo; index as i" class="contents">
          <video [hidden]="i != store.i" [muted]="true" [src]="file.filePath" (loadedmetadata)="$videoFileLoaded($event)" (timeupdate)="null"></video>
        </div>
      </div>
      <div id="playerCrop" [hidden]="!filters.filterInfo.filterCrop" [tooltip]="playerCrop" [tooltipKeep]="true"
        tooltipPlace="bottom" tooltipTheme="lite" tooltipTrigger="mouseenter" class="resizable"></div>
      <div #playerCrop class="player-crop">
        <div>
          <div>
            <p>W:</p>
            <input [(ngModel)]="store.state.filterInfo.filterWidth" (input)="videoSetCoordinates('w', $event)"
              min="0" [max]="store.state.playerInfo.playerWidth" type="number">
          </div>
          <div>
            <p>H:</p>
            <input [(ngModel)]="store.state.filterInfo.filterHeight" (input)="videoSetCoordinates('h', $event)"
              min="0" [max]="store.state.playerInfo.playerHeight" type="number">
          </div>
        </div>
        <span></span>
        <div>
          <div>
            <p>X:</p>
            <input [(ngModel)]="store.state.filterInfo.filterX" type="number" (input)="videoSetCoordinates('x', $event)"
              min="0" [max]="store.state.playerInfo.playerWidth - store.state.filterInfo.filterWidth">
          </div>
          <div>
            <p>Y:</p>
            <input [(ngModel)]="store.state.filterInfo.filterY" type="number" (input)="videoSetCoordinates('y', $event)"
              min="0" [max]="store.state.playerInfo.playerHeight - store.state.filterInfo.filterHeight">
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="!store.state.fileInfo[0]" class="player-open">
      <div>
        <img [src]="'/assets/images/open.svg'">
        <h1>{{ 'VIDEO_PLAYER.FILE_OPEN.TITLE' | translate }}</h1>
        <p>{{ 'VIDEO_PLAYER.FILE_OPEN.SUB' | translate }}</p>
        <span></span>
      </div>
      <input title="" type="file" (change)="videoFileOpen($event)" />
    </div>
  </div>
  <video-segments #videoSegments (added)="videoFileOpen($event)" (inited)="$videoSegments = videoSegments"
    (loaded)="videoSetPosition(filters.filterInfo.filterRotate)" (removed)="videoFileClose()"></video-segments>
</div>
<div class="player-controls" [class]="!store.state.fileInfo[0] ? 'pointer-events-none' : ''">
  <div class="player-buttons">
    <div class="flex">
      <ui-button buttonColor="dark" [buttonIcon]="(!playerInfo.playerVideo[store.i] || playerInfo.playerVideo[store.i].paused) || playerInfo.playerVideo[store.i]?.ended ? 'play' : 'pause'"
        [buttonToggle]="playerInfo.playerVideo[store.i] && !playerInfo.playerVideo[store.i].paused" [buttonTooltip]="'VIDEO_PLAYER.PLAY_PAUSE' | translate" (click)="videoPlayerPlay()"></ui-button>
      <ui-button buttonColor="dark" buttonIcon="stop" [buttonTooltip]="'VIDEO_PLAYER.STOP' | translate" (click)="videoPlayerStop()"></ui-button>
      <ui-button buttonColor="dark" [buttonIcon]="playerInfo.playerVideo[store.i]?.muted || playerInfo.playerVideo[store.i]?.volume == 0 ? 'mute' : 'volume'"
        [buttonTooltip]="'VIDEO_PLAYER.MUTE' | translate" (click)="videoPlayerMute()"></ui-button>
      <p>{{ (playerInfo.playerVideo[store.i]?.currentTime || 0) | duration: true }} / {{ (playerInfo.playerVideo[store.i]?.duration || 0) | duration: true }}</p>
    </div>
    <div>
      <ui-button buttonColor="dark" buttonIcon="capture" [buttonTooltip]="'VIDEO_PLAYER.CAPTURE' | translate" (click)="videoCapture.$videoCapture()"></ui-button>
      <ui-button buttonColor="dark" buttonIcon="segments" [buttonToggle]="$videoSegments.videoSegments" [buttonTooltip]="'VIDEO_PLAYER.SPLIT_MERGE' | translate" (click)="$videoSegments.$videoSegments()"></ui-button>
      <div class="player-separator"></div>
      <ui-button buttonColor="dark" buttonIcon="list" [buttonTooltip]="'VIDEO_PLAYER.LIST' | translate" (click)="$videoInfo.$videoInfo()"></ui-button>
      <ui-button buttonColor="dark" buttonIcon="clear" [buttonToggle]="filters.filterInfo.filterClear" [buttonTooltip]="'VIDEO_PLAYER.CLEAR' | translate" (click)="videoFilterClear()"></ui-button>
      <ui-button buttonColor="dark" buttonIcon="noaudio" [buttonToggle]="filters.filterInfo.filterNoAudio" [buttonTooltip]="'VIDEO_PLAYER.NO_AUDIO' | translate" (click)="videoFilterNoAudio()"></ui-button>
      <div class="player-separator"></div>
      <ui-button buttonColor="dark" buttonIcon="rotate" buttonIconClass="-scale-x-100" [buttonTooltip]="'VIDEO_PLAYER.ROTATE_CCW' | translate" (click)="videoFilterRotate(false)"></ui-button>
      <ui-button buttonColor="dark" buttonIcon="rotate" [buttonTooltip]="'VIDEO_PLAYER.ROTATE_CW' | translate" (click)="videoFilterRotate(true)"></ui-button>
      <ui-button buttonColor="dark" buttonIcon="flip" buttonIconClass="rotate-90" [buttonTooltip]="'VIDEO_PLAYER.FLIP_V' | translate" (click)="videoFilterFlip(true)"></ui-button>
      <ui-button buttonColor="dark" buttonIcon="flip" [buttonTooltip]="'VIDEO_PLAYER.FLIP_H' | translate" (click)="videoFilterFlip(false)"></ui-button>
      <ui-button buttonColor="dark" buttonIcon="crop" [buttonToggle]="filters.filterInfo.filterCrop" [buttonTooltip]="'VIDEO_PLAYER.CROP' | translate" (click)="videoFilterCrop()"></ui-button>
      <div class="player-separator"></div>
      <ui-button buttonColor="dark" buttonIcon="done" [buttonTooltip]="'VIDEO_PLAYER.DONE' | translate" (click)="$videoSave.$videoSave()"></ui-button>
      <ui-button buttonColor="dark" buttonIcon="close" [buttonTooltip]="'VIDEO_PLAYER.CLOSE' | translate" (click)="videoFileClose()"></ui-button>
    </div>
  </div>
  <ui-progress [progressTime]="playerInfo.playerVideo[store.i]?.currentTime" [progressDuration]="playerInfo.playerVideo[store.i]?.duration"
    (progressTimeChange)="playerInfo.playerVideo[store.i].currentTime = $event"></ui-progress>
</div>
<video-capture #videoCapture [currentTime]="playerInfo.playerVideo[store.i]?.currentTime"></video-capture>
<video-info #videoInfo (inited)="$videoInfo = videoInfo" (loaded)="videoFileLoaded()"></video-info>
<video-save #videoSave *ngIf="store.state.videoInfo[0]?.videoStreams" (loaded)="$videoSave = videoSave"></video-save>